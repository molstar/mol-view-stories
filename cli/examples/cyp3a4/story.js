// Common code for all scenes
// Mol* library functions: Vec3, Mat3, Mat4, Quat, Euler, decodeColor
builder.canvas({custom:{

  molstar_postprocessing: {
    enable_outline: true
  }}})

const coloring = { custom: {
  molstar_color_theme_name: 'element-symbol'
}}

const _1tqn = builder
.download({ url: '1tqn.bcif'})
.parse({ format: 'bcif' })
.modelStructure()
.transform({
  rotation: [
    0.6552433383, 0.0995189691, 0.748833855,
    0.7497798575, 0.0352069153, -0.6607500574,
    -0.0921212946, 0.9944126145, -0.0515482218,
  ],
  translation: [45.8176089191, 22.9477826026, 65.2697845164],
})

const _2v0m = builder
.download({ url: '2v0m.bcif'})
.parse({ format: 'bcif' })
.assemblyStructure()

// ketocanozole bound to the Hem
const ligandBound = _2v0m
.component({ selector: [{'label_asym_id': 'F' }]}) 

const ligandNotBound = _2v0m
.component({ selector: [{'label_asym_id': 'G' }]}) 

const catCore = _2v0m
.component({ selector: [{ 'label_seq_id': 420 }, { 'label_seq_id': 287 }]})

const hem = _2v0m
.component({ selector: {'label_asym_id': 'E' }})

const phe = [{ 'auth_seq_id': 213 }, { 'auth_seq_id': 215 }, { 'auth_seq_id': 219 }, { 'auth_seq_id': 220 }, { 'auth_seq_id': 108 }, { 'auth_seq_id': 241 }, { 'auth_seq_id': 304 }] // Phe-cluster

const colors = {
  '1tqn': '#EDF6F9',  
  '2v0m': '#83C5BE',
  phe:   '#E25B2E',    
  hem:   '#E29578',   
  helix: '#006D77',
  core: '#8C3123',
  ligand: '#4870C6'
}

const helices = {
  "F' helix": { 'beg_auth_seq_id': 217, 'end_auth_seq_id': 226 },
  "G' helix": { 'beg_auth_seq_id': 229, 'end_auth_seq_id': 236 },
  "F helix": { 'beg_auth_seq_id': 201, 'end_auth_seq_id': 209 },
  "G helix": { 'beg_auth_seq_id': 242, 'end_auth_seq_id': 263 }
}

const channel2f = [
  {
    "Radius": 2.865,
    "X": 20.915,
    "Y": 9.606,
    "Z": 66.569
  },
  {
    "Radius": 3.116,
    "X": 20.566,
    "Y": 11.204,
    "Z": 66.794
  },
  {
    "Radius": 3.994,
    "X": 19.52,
    "Y": 9.638,
    "Z": 65.436
  },
  {
    "Radius": 4.007,
    "X": 18.998,
    "Y": 9.685,
    "Z": 65.522
  },
  {
    "Radius": 3.781,
    "X": 17.914,
    "Y": 10.459,
    "Z": 64.515
  },
  {
    "Radius": 3.66,
    "X": 17.508,
    "Y": 10.837,
    "Z": 63.431
  },
  {
    "Radius": 3.628,
    "X": 17.299,
    "Y": 11.003,
    "Z": 62.734
  },
  {
    "Radius": 3.637,
    "X": 17.225,
    "Y": 11.089,
    "Z": 62.163
  },
  {
    "Radius": 3.588,
    "X": 17.047,
    "Y": 11.195,
    "Z": 61.624
  },
  {
    "Radius": 3.89,
    "X": 18.057,
    "Y": 11.056,
    "Z": 60.421
  },
  {
    "Radius": 4.019,
    "X": 18.791,
    "Y": 10.587,
    "Z": 59.226
  },
  {
    "Radius": 4.223,
    "X": 19.596,
    "Y": 9.896,
    "Z": 58.607
  },
  {
    "Radius": 4.385,
    "X": 20.194,
    "Y": 9.592,
    "Z": 58.48
  },
  {
    "Radius": 4.35,
    "X": 20.114,
    "Y": 9.475,
    "Z": 58.4
  },
  {
    "Radius": 4.228,
    "X": 20.046,
    "Y": 9.169,
    "Z": 57.809
  },
  {
    "Radius": 4.085,
    "X": 20.017,
    "Y": 8.766,
    "Z": 57.168
  },
  {
    "Radius": 3.78,
    "X": 20.256,
    "Y": 7.896,
    "Z": 55.478
  },
  {
    "Radius": 3.962,
    "X": 20.569,
    "Y": 6.967,
    "Z": 54.147
  },
  {
    "Radius": 4.031,
    "X": 20.471,
    "Y": 6.858,
    "Z": 53.876
  },
  {
    "Radius": 4.049,
    "X": 20.233,
    "Y": 7.01,
    "Z": 52.847
  },
  {
    "Radius": 4.047,
    "X": 20.228,
    "Y": 7.008,
    "Z": 52.872
  },
  {
    "Radius": 3.716,
    "X": 19.718,
    "Y": 6.742,
    "Z": 52.412
  },
  {
    "Radius": 2.987,
    "X": 18.184,
    "Y": 5.301,
    "Z": 50.502
  },
  {
    "Radius": 3.325,
    "X": 17.92,
    "Y": 3.782,
    "Z": 48.996
  },
  {
    "Radius": 3.029,
    "X": 17.452,
    "Y": 3.964,
    "Z": 48.549
  }
]

const channel4 = [
  {
    "Radius": 2.865,
    "X": 20.915,
    "Y": 9.606,
    "Z": 66.569
  },
  {
    "Radius": 2.974,
    "X": 20.735,
    "Y": 11.074,
    "Z": 66.904
  },
  {
    "Radius": 3.431,
    "X": 20.104,
    "Y": 10.66,
    "Z": 66.198
  },
  {
    "Radius": 4.05,
    "X": 19.385,
    "Y": 9.442,
    "Z": 65.335
  },
  {
    "Radius": 3.98,
    "X": 19.053,
    "Y": 9.611,
    "Z": 65.514
  },
  {
    "Radius": 3.783,
    "X": 18.217,
    "Y": 10.283,
    "Z": 64.904
  },
  {
    "Radius": 3.687,
    "X": 17.608,
    "Y": 10.681,
    "Z": 63.932
  },
  {
    "Radius": 3.659,
    "X": 17.486,
    "Y": 10.876,
    "Z": 63.286
  },
  {
    "Radius": 3.631,
    "X": 17.315,
    "Y": 10.996,
    "Z": 62.787
  },
  {
    "Radius": 3.617,
    "X": 17.248,
    "Y": 11.055,
    "Z": 62.303
  },
  {
    "Radius": 3.595,
    "X": 17.116,
    "Y": 11.16,
    "Z": 61.939
  },
  {
    "Radius": 3.648,
    "X": 17.089,
    "Y": 11.222,
    "Z": 61.467
  },
  {
    "Radius": 3.723,
    "X": 18.08,
    "Y": 10.893,
    "Z": 60.522
  },
  {
    "Radius": 3.73,
    "X": 18.193,
    "Y": 11.431,
    "Z": 59.566
  },
  {
    "Radius": 3.608,
    "X": 17.388,
    "Y": 12.564,
    "Z": 59.524
  },
  {
    "Radius": 3.445,
    "X": 17.231,
    "Y": 12.896,
    "Z": 59.749
  },
  {
    "Radius": 2.426,
    "X": 16.098,
    "Y": 12.502,
    "Z": 57.827
  },
  {
    "Radius": 1.951,
    "X": 14.845,
    "Y": 12.055,
    "Z": 55.662
  },
  {
    "Radius": 2.055,
    "X": 14.667,
    "Y": 12.074,
    "Z": 55.655
  },
  {
    "Radius": 1.934,
    "X": 14.2,
    "Y": 12.148,
    "Z": 55.652
  },
  {
    "Radius": 1.888,
    "X": 14.019,
    "Y": 11.991,
    "Z": 55.582
  },
  {
    "Radius": 1.773,
    "X": 13.595,
    "Y": 11.719,
    "Z": 55.069
  },
  {
    "Radius": 1.572,
    "X": 12.529,
    "Y": 11.615,
    "Z": 54.049
  },
  {
    "Radius": 1.516,
    "X": 12.287,
    "Y": 11.449,
    "Z": 53.449
  },
  {
    "Radius": 1.518,
    "X": 12.094,
    "Y": 11.565,
    "Z": 53.008
  },
  {
    "Radius": 1.664,
    "X": 11.518,
    "Y": 11.89,
    "Z": 52.474
  },
  {
    "Radius": 1.654,
    "X": 11.248,
    "Y": 11.727,
    "Z": 52.072
  },
  {
    "Radius": 2.02,
    "X": 10.059,
    "Y": 11.401,
    "Z": 50.993
  },
  {
    "Radius": 3.058,
    "X": 8.567,
    "Y": 11.303,
    "Z": 50.055
  },
  {
    "Radius": 3.492,
    "X": 7.604,
    "Y": 11.601,
    "Z": 50.104
  }
]

const channel2c = [
  {
    "Radius": 2.865,
    "X": 20.915,
    "Y": 9.606,
    "Z": 66.569
  },
  {
    "Radius": 3.06,
    "X": 20.641,
    "Y": 11.195,
    "Z": 66.86
  },
  {
    "Radius": 3.896,
    "X": 19.62,
    "Y": 9.811,
    "Z": 65.548
  },
  {
    "Radius": 3.994,
    "X": 19.067,
    "Y": 9.589,
    "Z": 65.509
  },
  {
    "Radius": 3.773,
    "X": 18.157,
    "Y": 10.318,
    "Z": 64.831
  },
  {
    "Radius": 3.661,
    "X": 17.53,
    "Y": 10.784,
    "Z": 63.622
  },
  {
    "Radius": 3.631,
    "X": 17.364,
    "Y": 10.969,
    "Z": 62.871
  },
  {
    "Radius": 3.598,
    "X": 17.202,
    "Y": 11.077,
    "Z": 62.364
  },
  {
    "Radius": 3.644,
    "X": 17.204,
    "Y": 11.112,
    "Z": 61.755
  },
  {
    "Radius": 3.642,
    "X": 17.056,
    "Y": 11.363,
    "Z": 61.244
  },
  {
    "Radius": 3.535,
    "X": 16.755,
    "Y": 11.905,
    "Z": 61.101
  },
  {
    "Radius": 3.422,
    "X": 16.395,
    "Y": 12.483,
    "Z": 60.713
  },
  {
    "Radius": 3.069,
    "X": 15.356,
    "Y": 13.331,
    "Z": 60.266
  },
  {
    "Radius": 2.773,
    "X": 14.392,
    "Y": 14.256,
    "Z": 60.58
  },
  {
    "Radius": 2.304,
    "X": 14.224,
    "Y": 15.426,
    "Z": 60.438
  },
  {
    "Radius": 1.791,
    "X": 12.727,
    "Y": 17.474,
    "Z": 59.015
  },
  {
    "Radius": 1.797,
    "X": 12.432,
    "Y": 17.809,
    "Z": 59.071
  },
  {
    "Radius": 1.855,
    "X": 12.226,
    "Y": 18.39,
    "Z": 58.882
  },
  {
    "Radius": 1.83,
    "X": 12.169,
    "Y": 18.662,
    "Z": 58.673
  },
  {
    "Radius": 1.753,
    "X": 12.147,
    "Y": 18.362,
    "Z": 58.964
  },
  {
    "Radius": 1.06,
    "X": 12.537,
    "Y": 19.819,
    "Z": 57.498
  },
  {
    "Radius": 1.268,
    "X": 12.749,
    "Y": 21.145,
    "Z": 55.505
  },
  {
    "Radius": 1.328,
    "X": 12.116,
    "Y": 21.267,
    "Z": 54.9
  },
  {
    "Radius": 1.542,
    "X": 11.683,
    "Y": 22.244,
    "Z": 54.198
  },
  {
    "Radius": 2.07,
    "X": 11.469,
    "Y": 23.231,
    "Z": 53.458
  },
  {
    "Radius": 2.04,
    "X": 11.76,
    "Y": 23.454,
    "Z": 53.089
  },
  {
    "Radius": 2.405,
    "X": 12.669,
    "Y": 24.216,
    "Z": 52.402
  },
  {
    "Radius": 2.498,
    "X": 12.089,
    "Y": 25.054,
    "Z": 52.645
  },
  {
    "Radius": 2.306,
    "X": 11.719,
    "Y": 25.614,
    "Z": 52.321
  },
  {
    "Radius": 2.57,
    "X": 10.859,
    "Y": 27.687,
    "Z": 51.517
  }
]
const channel2e = [
  {
    "Radius": 2.865,
    "X": 20.915,
    "Y": 9.606,
    "Z": 66.569
  },
  {
    "Radius": 3.005,
    "X": 20.704,
    "Y": 11.133,
    "Z": 66.896
  },
  {
    "Radius": 3.645,
    "X": 19.858,
    "Y": 10.236,
    "Z": 65.855
  },
  {
    "Radius": 3.972,
    "X": 19.215,
    "Y": 9.385,
    "Z": 65.385
  },
  {
    "Radius": 3.953,
    "X": 18.59,
    "Y": 10.049,
    "Z": 65.287
  },
  {
    "Radius": 3.748,
    "X": 17.732,
    "Y": 10.577,
    "Z": 64.219
  },
  {
    "Radius": 3.66,
    "X": 17.498,
    "Y": 10.857,
    "Z": 63.357
  },
  {
    "Radius": 3.63,
    "X": 17.303,
    "Y": 11.003,
    "Z": 62.751
  },
  {
    "Radius": 3.618,
    "X": 17.244,
    "Y": 11.063,
    "Z": 62.237
  },
  {
    "Radius": 3.549,
    "X": 17.054,
    "Y": 11.2,
    "Z": 61.857
  },
  {
    "Radius": 3.696,
    "X": 17.453,
    "Y": 11.088,
    "Z": 61.075
  },
  {
    "Radius": 3.959,
    "X": 18.449,
    "Y": 10.995,
    "Z": 59.894
  },
  {
    "Radius": 3.614,
    "X": 17.537,
    "Y": 12.322,
    "Z": 59.481
  },
  {
    "Radius": 3.403,
    "X": 17.225,
    "Y": 13.028,
    "Z": 59.372
  },
  {
    "Radius": 3.017,
    "X": 17.372,
    "Y": 13.87,
    "Z": 59.369
  },
  {
    "Radius": 2.506,
    "X": 17.607,
    "Y": 15.035,
    "Z": 59.408
  },
  {
    "Radius": 2.331,
    "X": 17.641,
    "Y": 15.497,
    "Z": 59.138
  },
  {
    "Radius": 2.071,
    "X": 18.028,
    "Y": 15.271,
    "Z": 58.181
  },
  {
    "Radius": 1.052,
    "X": 20.563,
    "Y": 15.772,
    "Z": 56.428
  },
  {
    "Radius": 1.25,
    "X": 21.594,
    "Y": 16.21,
    "Z": 56.005
  },
  {
    "Radius": 1.261,
    "X": 22.4,
    "Y": 15.994,
    "Z": 56.157
  },
  {
    "Radius": 1.433,
    "X": 23.375,
    "Y": 15.506,
    "Z": 56.321
  },
  {
    "Radius": 1.629,
    "X": 24.096,
    "Y": 15.225,
    "Z": 56.635
  },
  {
    "Radius": 1.775,
    "X": 24.6,
    "Y": 15.708,
    "Z": 56.584
  },
  {
    "Radius": 1.636,
    "X": 23.812,
    "Y": 16.995,
    "Z": 56.02
  },
  {
    "Radius": 2.024,
    "X": 24.447,
    "Y": 17.855,
    "Z": 55.194
  },
  {
    "Radius": 2.563,
    "X": 24.913,
    "Y": 18.993,
    "Z": 54.926
  },
  {
    "Radius": 2.956,
    "X": 24.793,
    "Y": 20.365,
    "Z": 54.133
  },
  {
    "Radius": 4.012,
    "X": 25.4,
    "Y": 20.913,
    "Z": 52.341
  },
  {
    "Radius": 3.891,
    "X": 25.629,
    "Y": 20.401,
    "Z": 51.956
  }
]

const solventChannel = [
  {
    "Radius": 2.082,
    "X": 16.876,
    "Y": 9.7,
    "Z": 69.351
  },
  {
    "Radius": 2.237,
    "X": 16.519,
    "Y": 10.452,
    "Z": 70.954
  },
  {
    "Radius": 2.296,
    "X": 16.468,
    "Y": 10.491,
    "Z": 71.099
  },
  {
    "Radius": 2.076,
    "X": 17.215,
    "Y": 11.271,
    "Z": 70.609
  },
  {
    "Radius": 2.224,
    "X": 18.117,
    "Y": 12.073,
    "Z": 69.835
  },
  {
    "Radius": 2.929,
    "X": 19.22,
    "Y": 12.17,
    "Z": 67.857
  },
  {
    "Radius": 3.186,
    "X": 19.455,
    "Y": 12.252,
    "Z": 67.372
  },
  {
    "Radius": 3.561,
    "X": 19.135,
    "Y": 10.232,
    "Z": 66.04
  },
  {
    "Radius": 3.636,
    "X": 18.155,
    "Y": 10.048,
    "Z": 64.653
  },
  {
    "Radius": 3.562,
    "X": 17.574,
    "Y": 10.943,
    "Z": 63.934
  },
  {
    "Radius": 3.021,
    "X": 16.475,
    "Y": 10.509,
    "Z": 64.333
  },
  {
    "Radius": 2.642,
    "X": 15.933,
    "Y": 9.717,
    "Z": 65.21
  },
  {
    "Radius": 2.685,
    "X": 16.01,
    "Y": 9.352,
    "Z": 65.586
  },
  {
    "Radius": 2.185,
    "X": 14.709,
    "Y": 9.193,
    "Z": 65.39
  },
  {
    "Radius": 1.936,
    "X": 13.851,
    "Y": 9.232,
    "Z": 65.253
  },
  {
    "Radius": 1.705,
    "X": 13.819,
    "Y": 8.317,
    "Z": 65.384
  },
  {
    "Radius": 1.37,
    "X": 13.736,
    "Y": 7.045,
    "Z": 65.554
  },
  {
    "Radius": 1.402,
    "X": 14.04,
    "Y": 6.921,
    "Z": 65.638
  },
  {
    "Radius": 1.372,
    "X": 13.528,
    "Y": 6.018,
    "Z": 65.462
  },
  {
    "Radius": 1.753,
    "X": 12.643,
    "Y": 5.002,
    "Z": 65.092
  },
  {
    "Radius": 1.75,
    "X": 12.757,
    "Y": 4.984,
    "Z": 65.114
  },
  {
    "Radius": 1.786,
    "X": 12.74,
    "Y": 4.498,
    "Z": 64.674
  },
  {
    "Radius": 1.81,
    "X": 12.805,
    "Y": 3.961,
    "Z": 64.094
  },
  {
    "Radius": 1.678,
    "X": 12.582,
    "Y": 3.94,
    "Z": 63.747
  },
  {
    "Radius": 1.611,
    "X": 11.435,
    "Y": 3.496,
    "Z": 61.563
  },
  {
    "Radius": 1.738,
    "X": 11.412,
    "Y": 3.789,
    "Z": 61.406
  },
  {
    "Radius": 1.713,
    "X": 11.206,
    "Y": 4.983,
    "Z": 60.879
  },
  {
    "Radius": 1.623,
    "X": 9.989,
    "Y": 5.925,
    "Z": 60.748
  },
  {
    "Radius": 2.132,
    "X": 8.634,
    "Y": 6.985,
    "Z": 60.02
  },
  {
    "Radius": 2.266,
    "X": 8.289,
    "Y": 7.086,
    "Z": 59.896
  }
]

const channel2b = [
  {
    "Radius": 2.082,
    "X": 16.876,
    "Y": 9.7,
    "Z": 69.351
  },
  {
    "Radius": 2.325,
    "X": 16.443,
    "Y": 10.506,
    "Z": 71.165
  },
  {
    "Radius": 2.158,
    "X": 16.759,
    "Y": 10.767,
    "Z": 70.874
  },
  {
    "Radius": 2.164,
    "X": 17.852,
    "Y": 11.919,
    "Z": 70.158
  },
  {
    "Radius": 2.79,
    "X": 19.098,
    "Y": 12.164,
    "Z": 68.089
  },
  {
    "Radius": 3.24,
    "X": 19.427,
    "Y": 12.141,
    "Z": 67.329
  },
  {
    "Radius": 3.897,
    "X": 18.885,
    "Y": 9.751,
    "Z": 65.45
  },
  {
    "Radius": 3.711,
    "X": 17.654,
    "Y": 10.708,
    "Z": 64.1
  },
  {
    "Radius": 3.617,
    "X": 17.402,
    "Y": 10.922,
    "Z": 62.994
  },
  {
    "Radius": 3.633,
    "X": 17.237,
    "Y": 11.076,
    "Z": 62.28
  },
  {
    "Radius": 3.585,
    "X": 17.047,
    "Y": 11.194,
    "Z": 61.624
  },
  {
    "Radius": 3.972,
    "X": 18.332,
    "Y": 10.979,
    "Z": 60.116
  },
  {
    "Radius": 4.12,
    "X": 19.014,
    "Y": 10.302,
    "Z": 58.898
  },
  {
    "Radius": 4.374,
    "X": 20.111,
    "Y": 9.626,
    "Z": 58.482
  },
  {
    "Radius": 4.364,
    "X": 20.132,
    "Y": 9.508,
    "Z": 58.434
  },
  {
    "Radius": 4.212,
    "X": 20.045,
    "Y": 9.143,
    "Z": 57.752
  },
  {
    "Radius": 4.03,
    "X": 20.032,
    "Y": 8.592,
    "Z": 56.913
  },
  {
    "Radius": 3.939,
    "X": 20.468,
    "Y": 7.344,
    "Z": 54.413
  },
  {
    "Radius": 4.036,
    "X": 20.518,
    "Y": 6.808,
    "Z": 54.149
  },
  {
    "Radius": 4.037,
    "X": 20.318,
    "Y": 7.055,
    "Z": 52.885
  },
  {
    "Radius": 3.874,
    "X": 20.227,
    "Y": 6.799,
    "Z": 53.013
  },
  {
    "Radius": 2.875,
    "X": 21.36,
    "Y": 8.704,
    "Z": 51.617
  },
  {
    "Radius": 2.816,
    "X": 23.506,
    "Y": 9.92,
    "Z": 49.562
  },
  {
    "Radius": 2.902,
    "X": 24.7,
    "Y": 10.058,
    "Z": 48.966
  },
  {
    "Radius": 2.941,
    "X": 24.88,
    "Y": 10.112,
    "Z": 48.857
  },
  {
    "Radius": 2.922,
    "X": 25.363,
    "Y": 10.259,
    "Z": 48.855
  },
  {
    "Radius": 2.865,
    "X": 26.218,
    "Y": 10.463,
    "Z": 49.054
  },
  {
    "Radius": 2.399,
    "X": 26.81,
    "Y": 10.474,
    "Z": 48.199
  },
  {
    "Radius": 2.17,
    "X": 29.557,
    "Y": 10.233,
    "Z": 46.028
  },
  {
    "Radius": 2.912,
    "X": 30.903,
    "Y": 10.594,
    "Z": 45.234
  }
]

const channel1 = [
  {
    "Radius": 2.082,
    "X": 16.876,
    "Y": 9.7,
    "Z": 69.351
  },
  {
    "Radius": 1.996,
    "X": 16.726,
    "Y": 10.224,
    "Z": 70.551
  },
  {
    "Radius": 2.404,
    "X": 16.094,
    "Y": 10.735,
    "Z": 71.436
  },
  {
    "Radius": 2.443,
    "X": 15.357,
    "Y": 11.079,
    "Z": 71.857
  },
  {
    "Radius": 2.395,
    "X": 15.4,
    "Y": 11.199,
    "Z": 71.903
  },
  {
    "Radius": 2.262,
    "X": 15.75,
    "Y": 12.103,
    "Z": 71.935
  },
  {
    "Radius": 2.438,
    "X": 15.644,
    "Y": 13.21,
    "Z": 72.031
  },
  {
    "Radius": 2.391,
    "X": 15.09,
    "Y": 13.602,
    "Z": 72.041
  },
  {
    "Radius": 2.41,
    "X": 14.888,
    "Y": 13.632,
    "Z": 71.992
  },
  {
    "Radius": 2.405,
    "X": 14.945,
    "Y": 13.674,
    "Z": 72.058
  },
  {
    "Radius": 2.338,
    "X": 14.819,
    "Y": 13.764,
    "Z": 72.157
  },
  {
    "Radius": 2.352,
    "X": 14.857,
    "Y": 13.706,
    "Z": 71.903
  },
  {
    "Radius": 1.914,
    "X": 14.417,
    "Y": 14.203,
    "Z": 72.77
  },
  {
    "Radius": 1.667,
    "X": 13.244,
    "Y": 15.475,
    "Z": 75.244
  },
  {
    "Radius": 1.765,
    "X": 13.081,
    "Y": 15.65,
    "Z": 75.596
  },
  {
    "Radius": 1.692,
    "X": 13.232,
    "Y": 15.489,
    "Z": 75.289
  },
  {
    "Radius": 1.728,
    "X": 13.157,
    "Y": 15.526,
    "Z": 75.446
  },
  {
    "Radius": 1.663,
    "X": 13.032,
    "Y": 15.552,
    "Z": 75.748
  },
  {
    "Radius": 1.7,
    "X": 13.039,
    "Y": 15.93,
    "Z": 76.281
  },
  {
    "Radius": 1.628,
    "X": 13.332,
    "Y": 16.634,
    "Z": 76.796
  },
  {
    "Radius": 1.578,
    "X": 13.883,
    "Y": 17.287,
    "Z": 76.797
  },
  {
    "Radius": 1.643,
    "X": 13.876,
    "Y": 17.848,
    "Z": 76.703
  },
  {
    "Radius": 1.537,
    "X": 13.762,
    "Y": 18.55,
    "Z": 77.303
  },
  {
    "Radius": 1.452,
    "X": 14.251,
    "Y": 19.57,
    "Z": 78.521
  },
  {
    "Radius": 1.482,
    "X": 14.589,
    "Y": 20.029,
    "Z": 78.874
  },
  {
    "Radius": 1.526,
    "X": 14.155,
    "Y": 20.011,
    "Z": 79.749
  },
  {
    "Radius": 2.111,
    "X": 13.159,
    "Y": 20.032,
    "Z": 81.701
  },
  {
    "Radius": 2.366,
    "X": 12.236,
    "Y": 20.173,
    "Z": 82.407
  },
  {
    "Radius": 2.352,
    "X": 11.618,
    "Y": 20.814,
    "Z": 82.553
  },
  {
    "Radius": 2.697,
    "X": 11.21,
    "Y": 22.245,
    "Z": 83.235
  }
]


function buildChannel(points, color, label, opa) {
  points.forEach((p, index) => {
    builder.primitives({ opacity: opa, ref: `${label}_${index}` })
    .ellipsoid({
      center: [ p.X, p.Y, p.Z ],
      major_axis: [1, 0, 0],
      minor_axis: [0, 1, 0],
      radius: [p.Radius, p.Radius, p.Radius],
      color: color,
      tooltip: (label === 's') ? 'Solvent channel' : `Channel ${label}`
    });
  });
  builder.primitives({
    label_background_color: color
  })
  .label({
    text: (label === 's') ? 'Solvent channel' : `Channel ${label}`,
    position: [points[points.length - 1].X, points[points.length - 1].Y, points[points.length - 1].Z],
    label_offset: 5,
    label_size: 3,
    label_color: 'white'
  })
}

const channels = {
  channel2f: { data: channel2f, color: 'palegreen', label: '2f' },
  channel4:  { data: channel4,  color: 'pink',      label: '4'  },
  channel2c: { data: channel2c, color: 'beige',     label: '2c' },
  channel2e: { data: channel2e, color: 'cyan',      label: '2e' },
  channel2b: { data: channel2b, color: 'violet', label: '2b'},
  channelS: { data: solventChannel, color: 'orange', label: 's'},
  channel1: { data: channel1, color: 'grey', label: '1'}
};


const makeEmissivePulse = (ref, start_ms, dur, freq) => ({
  kind: 'scalar',
  target_ref: ref,
  start_ms: start_ms,
  duration_ms: dur,
  frequency: freq,
  alternate_direction: true,
  property: ['custom', 'molstar_representation_params', 'emissive'],
  end: 1.0,
});

