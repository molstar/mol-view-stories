import fs from 'fs';

let data = fs.readFileSync('./tmp/mvs.d.ts', 'utf-8');
data = data.replaceAll('`', '\\`').replaceAll('${', '\\${').replaceAll(/(\r\n|\n|\r)/g, '\n');

const lines = data.split('\n'); // .filter(line => !line.startsWith('export '));
const final = [
    '// Automatically generated file. Do not edit manually.',
    '// This file is generated by npm run mvs-types',
    '',
    'export const MVSTypes = `',
    'namespace _ {',
    ...lines.map(line => `    ${line}`),
    '}',
    '',
    'declare const builder: _.Builder;',
    'declare const Vec3: typeof _.Vec3;',
    'declare const Mat3: typeof _.Mat3;',
    'declare const Mat4: typeof _.Mat4;',
    'declare const Quat: typeof _.Quat;',
    '`;',
];

fs.writeFileSync('./src/components/story-builder/editors/mvs-typing.ts', final.join('\n'), 'utf-8');